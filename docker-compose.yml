services:
  feishu-bridge:
    build: .
    ports:
      - "9811:9811"
    environment:
      - FEISHU_APP_ID=${FEISHU_APP_ID}
      - FEISHU_APP_SECRET=${FEISHU_APP_SECRET}
      - FEISHU_WEBHOOK_URLS=${FEISHU_WEBHOOK_URLS}
      - STREAMING_ENABLED=${STREAMING_ENABLED:-false}
      - STREAMING_PROVIDER=${STREAMING_PROVIDER:-openai}
      - STREAMING_REPLY_MODE=${STREAMING_REPLY_MODE:-false}
      - STREAMING_OPENAI_API_URL=${STREAMING_OPENAI_API_URL:-https://api.openai.com/v1/chat/completions}
      - STREAMING_OPENAI_API_KEY=${STREAMING_OPENAI_API_KEY:-}
      - STREAMING_OPENAI_MODEL=${STREAMING_OPENAI_MODEL:-gpt-4o}
      - STREAMING_OPENAI_SYSTEM_PROMPT=${STREAMING_OPENAI_SYSTEM_PROMPT:-}
      - STREAMING_DIFY_API_URL=${STREAMING_DIFY_API_URL:-}
      - STREAMING_DIFY_API_KEY=${STREAMING_DIFY_API_KEY:-}
      - STREAMING_DIFY_APP_TYPE=${STREAMING_DIFY_APP_TYPE:-chat}
      - STREAMING_MEMORY_ENABLED=${STREAMING_MEMORY_ENABLED:-false}
      - STREAMING_MEMORY_MAX_MESSAGES=${STREAMING_MEMORY_MAX_MESSAGES:-0}
      - STREAMING_LOG_ENABLED=${STREAMING_LOG_ENABLED:-false}
      - STREAMING_LOG_DIR=${STREAMING_LOG_DIR:-logs/conversations}
      - STREAMING_LOG_MAX_FILES=${STREAMING_LOG_MAX_FILES:-100}
    volumes:
      - ./logs:/app/logs
    restart: unless-stopped
